<html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Javascriptの皮を被ったXML #2 - Gosuke Miyashita</title>
<link rel="stylesheet" href="/css/fonts.css" type="text/css" charset="utf-8">
<link rel="stylesheet/tass" type="text/x-tass" href="/css/style.tass"/>
<script type="text/javascript" src="/js/tass.js"></script>
<link href="/atom.xml" rel="alternate" title="Gosuke Miyashita" type="application/atom+xml">
</head>
<body>
<h1 class="site-title"><a href="/">Gosuke Miyashita</a></h1>

<div class="content autopagerize_page_element">

  <time>Jul 2<span>nd</span>, 2005</time>
  <h1 class="entry-title"><a href="/blog/2005/07/02/3">Javascriptの皮を被ったXML #2</a></h1>

  <div class="content">
    <p class="entryBody">
<a href="http://mizzy.org/program/javaScriptOverXml01.html" target="_blank">Javascriptの皮を被ったXML #1</a>の続きです。del.icio.us direc.torのGreasemonkey版<a href="http://mizzy.org/js/dboot.user.js" target="_blank">dboot.user.js</a>のHTMLを外部ファイルに分離し、GM_xmlhttpRequestでHTMLを取得するようにしてみました。
</p>

<pre class="code">
// ==UserScript==
// @name            del.icio.us direc.tor greasemonkey user script
// @namespace       http://mizzy.org/
// @description     When open a folder in bloglines, close other folders.
// @include         http://del.icio.us/mizzy/director
// ==/UserScript==

var d;
GM_xmlhttpRequest({
          method: 'GET',
          url: 'http://mizzy.org/director/ui.html',
          onload: function(r){
              d = r.responseText;
              init();
          },
          });

function init() {

    var i, a, main;

    document.body.innerHTML = "";
    document.body.innerHTML = d;
    
    for(i=0; (a = document.getElementsByTagName("link")[i]); i++) {
      if(a.getAttribute("rel").indexOf("style") != -1) {
        a.disabled = true;
      }
    }
    
    var ns = document.createElement("link");
    ns.rel = "stylesheet";
    ns.type = "text/css";
    ns.href = "http://johnvey.com/features/deliciousdirector/d.css";
    document.body.appendChild(ns);
    
    var js = document.createElement("script");
    js.language = "javascript";
    js.src = "http://johnvey.com/features/deliciousdirector/d.js";
    document.body.appendChild(js);
    
    document.title += " (Direc.tor)";
}
</pre>

<p class="entryBody">
前回のものと比べると、コードの前半部分がかなりすっきりしましたね。実際に試してみたい方は、<a href="http://mizzy.org/js/dboot.mizzy.user.js" target="_blank">こちら</a>。
</p>

<p class="entryBody">
このエントリ、前回とまとめちゃった方が良かったすね。予想外にあっさりうまくいってしまいました。
</p>

  </div>


  <div class="pagination">
    
    <a href="/blog/2005/07/02/2" rel="next">next post</a>
    
    
    
    <a href="/blog/2005/07/23/1">previous post</a>
    
  </div>

</div>

<div class="autopagerize_insert_before"></div>

</body>
</html>
