
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Gosuke Miyashita</title>
  <meta name="author" content="Gosuke Miyashita">

  
  <meta name="description" content="ここ でメールアドレスを登録しておいたら、招待状が届きました。というわけで、せっかくなので英語ブログ をはじめることにしました。なんか最近ギークな人たちの間で英語ブログが流行ってるみたいなので、便乗してみます。 このブログは perl プログラミング関連のことばかり書いていて、 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://mizzy.org/blog/page/25">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Gosuke Miyashita" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-53984-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Gosuke Miyashita</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:mizzy.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2006/07/20/502/">Vox で英語ブログはじめました</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2006-07-20T19:04:00+09:00" pubdate>Jul 20<span>th</span>, 2006</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
<a class="ext-link" href="http://www.sixapart.com/vox/"><span class="icon"></span>ここ</a> でメールアドレスを登録しておいたら、招待状が届きました。というわけで、せっかくなので<a class="ext-link" href="http://mizzy.vox.com/"><span class="icon"></span>英語ブログ</a> をはじめることにしました。なんか最近ギークな人たちの間で英語ブログが流行ってるみたいなので、便乗してみます。
</p>


<p>
このブログは perl プログラミング関連のことばかり書いていて、見に来てくださる方々もそれを期待していると思われるので、他のことが書きにくいんですよね。なので、vox ではここには書かない、割とどうでもいい日常的なことばかり書くことになると思います。
</p>


<p>
さて、いつまで続くことやら…そのうち英語で書くのがめんどくなって、日本語になりそうな予感。
</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2006/07/18/366/">『ふつうの Haskell』を読む前に</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2006-07-18T22:01:00+09:00" pubdate>Jul 18<span>th</span>, 2006</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
『<a class="ext-link" href="http://www.amazon.co.jp/exec/obidos/ASIN/4274065979/httshemizorg-22/ref=nosim"><span class="icon"></span>ハッカーと画家</a>』を読んだ時に、関数型言語を何かひとつ、かじる程度でいいから学びたいなぁ、と思っていたのですが、当時はどこから学んで良いのかもよく分からない状態でした。
</p>


<p>
そのまますっかりそのことは忘れていたのですが、最近の Haskell ブームのあおりでふと思い出したので、『<a class="ext-link" href="http://www.amazon.co.jp/exec/obidos/ASIN/4797336021/httshemizorg-22/ref=nosim"><span class="icon"></span>ふつうの Haskell</a>』 を Amazon に発注して、それが今日届きました。何か乗り遅れた感がありますが気にしない。
</p>


<p>
で、以前に、関数型言語とセットでよく出てくる「ラムダ」って何？と思って調べていて参考になった資料を以下に挙げておきます。
</p>


<ul><li><a class="ext-link" href="http://ja.wikipedia.org/wiki/%E3%83%A9%E3%83%A0%E3%83%80%E8%A8%88%E7%AE%97"><span class="icon"></span>ラムダ計算 - Wikipedia</a></li>
<li><a class="ext-link" href="http://members.at.infoseek.co.jp/nbz/ref/lambda.html"><span class="icon"></span>ラムダ計算ＡＢＣ</a></li>
<li><a class="ext-link" href="http://www.kurims.kyoto-u.ac.jp/~cs/csnyumon/appendix_A.pdf"><span class="icon"></span>ラムダ計算：プログラミング言語の数学モデル (pdf)</a></li>
<li><a class="ext-link" href="http://www.kb.ecei.tohoku.ac.jp/~sumii/class/keisanki-software-kougaku-2005/lambda.pdf"><span class="icon"></span>ラムダ計算入門 (pdf)</a></li></ul>


<p>
ラムダ計算は関数型言語の理論的基盤なので、Haskell の理解に役立つのではないかと。『ふつうの Haskell』の最初の方でも、「関数適用」や「変数の束縛」などといった用語が出てきますが、これらはラムダ計算の用語ですし。
</p>


<p>
ただし、知っていれば Haskell の理解に役立つかもしれないけど、知らないと理解できないというものでもないので、数学苦手な方は読まない方がいいと思います。この本の著者の方も、数学知らなくても Haskell 学ぶことはできる、っておっしゃってますし。
</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2006/07/02/316/">Atom Threading Extensions</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2006-07-02T13:49:00+09:00" pubdate>Jul 2<span>nd</span>, 2006</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
IRC で miyagawa さんが貼っていた URL 経由で見つけたのですが、<a class="ext-link" href="http://www.ietf.org/internet-drafts/draft-snell-atompub-feed-thread-12.txt"><span class="icon"></span>Atom Threading Extensions</a> なんてものがあったのですね。
</p>


<p>
要するに、Atom Syndication Format で、メーリングリストや掲示板の様なスレッドを表現するための仕組みです。
</p>


<p>
コメントやトラックバックの関連を視覚化、というアイデアは色んな人達が考えていると思うのですが、それをサポートするような規格が既にあったとは知りませんでした。
</p>


<p>
ここではざっと要点だけご紹介します。詳細知りたい方は原文をお読みください。そんなにボリュームないですし。（このエントリも間違っている可能性があるので、できれば原文読んで頂いた方が良いかと。）
</p>


<h3 id="in-reply-to拡張要素">&#8216;in-reply-to&#8217; 拡張要素</h3>


<p>
entry 要素の子要素として指定するもので、そのエントリが、どのエントリに対する reply なのかを示す要素です。
</p>


<pre class="wiki">
&lt;feed xmlns="http://www.w3.org/2005/Atom"
    xmlns:thr="http://purl.org/syndication/thread/1.0"&gt;
    &lt;id&gt;http://www.example.org/myfeed&lt;/id&gt;
    &lt;title&gt;My Example Feed&lt;/title&gt;
    &lt;updated&gt;2005-07-28T12:00:00Z&lt;/updated&gt;
    &lt;link href="http://www.example.org/myfeed" /&gt;
    &lt;author&gt;&lt;name&gt;James&lt;/name&gt;&lt;/author&gt;
    &lt;entry&gt;
        &lt;id&gt;tag:example.org,2005:1&lt;/id&gt;
        &lt;title&gt;My original entry&lt;/title&gt;
        &lt;updated&gt;2006-03-01T12:12:12Z&lt;/updated&gt;
        &lt;link
          type="application/xhtml+xml"
          href="http://www.example.org/entries/1" /&gt;
        &lt;summary&gt;This is my original entry&lt;/summary&gt;
    &lt;/entry&gt;
    &lt;entry&gt;
        &lt;id&gt;tag:example.org,2005:1,1&lt;/id&gt;
        &lt;title&gt;A response to the original&lt;/title&gt;
        &lt;updated&gt;2006-03-01T12:12:12Z&lt;/updated&gt;
        &lt;link href="http://www.example.org/entries/1/1" /&gt;
        <strong>&lt;thr:in-reply-to
          ref="tag:example.org,2005:1"
          type="application/xhtml+xml"
          href="http://www.example.org/entries/1"/&gt;</strong>
        &lt;summary&gt;This is a response to the original entry&lt;/summary&gt;
    &lt;/entry&gt;
&lt;/feed&gt;
</pre>


<p>
この例では、2番目の entry が最初の entry に対する reply となっています。各属性の意味は以下の通りです。
</p>


<dl>
<dt>ref</dt>
<dd>
元エントリの atom:id 要素。
</dd>
<dt>href</dt>
<dd>
元エントリの IRI。
</dd>
<dt>type</dt>
<dd>
元エントリのメディアタイプ。
</dd>
<dt>source</dt>
<dd>
元エントリが含まれる Atom Feed または Entry の IRI。
</dd>
</dl>


<h3 id="replieslinkrelation">&#8216;replies&#8217; link relation</h3>


<p>
link 要素の rel 属性として replies を指定することで、その entry に対する reply が含まれている（かもしれない）リソースを参照します。
</p>


<pre class="wiki">
&lt;feed xmlns="http://www.w3.org/2005/Atom"
      xmlns:thr="http://purl.org/syndication/thread/1.0"&gt;
    &lt;id&gt;http://www.example.org/myfeed&lt;/id&gt;
    &lt;title&gt;My Example Feed&lt;/title&gt;
    &lt;updated&gt;2005-07-28T12:00:00Z&lt;/updated&gt;
    &lt;link href="http://www.example.org/myfeed" /&gt;
    &lt;author&gt;&lt;name&gt;James&lt;/name&gt;&lt;/author&gt;
    &lt;entry&gt;
        &lt;id&gt;tag:entries.com,2005:1&lt;/id&gt;
        &lt;title&gt;My original entry&lt;/title&gt;
        &lt;updated&gt;2006-03-01T12:12:12Z&lt;/updated&gt;
        &lt;link href="http://www.example.org/entries/1" /&gt;
        <strong>&lt;link rel="replies"
              type="application/atom+xml"
              href="http://www.example.org/mycommentsfeed.xml"
              thr:count="10" thr:updated="2005-07-28T12:10:00Z" /&gt;</strong>
        &lt;summary&gt;This is my original entry&lt;/summary&gt;
    &lt;/entry&gt;
&lt;/feed&gt;
</pre>


<p>
この link 要素は thr:count 属性と thr:updated 属性を持つことができます。各属性の意味は以下の通りです。
</p>


<dl>
<dt>thr:count</dt>
<dd>
href で示されるリソースに含まれている reply の数。
</dd>
<dt>thr:updated</dt>
<dd>
href で示されるリソース内の reply の最終更新日時。
</dd>
</dl>


<p>
どちらの属性も補助的なものであって、正確な数値でなくとも良い、という点には注意が必要です。
</p>


<h3 id="total拡張要素">&#8216;total&#8217; 拡張要素</h3>


<p>
entry に対する reply の総数です。ドラフトにはサンプルがなかったので、以下の例は適当です。間違ってたらごめんなさい。
</p>


<pre class="wiki">
&lt;feed xmlns="http://www.w3.org/2005/Atom"
    xmlns:thr="http://purl.org/syndication/thread/1.0"&gt;
    &lt;id&gt;http://www.example.org/myfeed&lt;/id&gt;
    &lt;title&gt;My Example Feed&lt;/title&gt;
    &lt;updated&gt;2005-07-28T12:00:00Z&lt;/updated&gt;
    &lt;link href="http://www.example.org/myfeed" /&gt;
    &lt;author&gt;&lt;name&gt;James&lt;/name&gt;&lt;/author&gt;
    &lt;entry&gt;
        &lt;id&gt;tag:example.org,2005:1&lt;/id&gt;
        &lt;title&gt;My original entry&lt;/title&gt;
        &lt;updated&gt;2006-03-01T12:12:12Z&lt;/updated&gt;
        &lt;link
          type="application/xhtml+xml"
          href="http://www.example.org/entries/1" /&gt;
        &lt;summary&gt;This is my original entry&lt;/summary&gt;
        <strong>&lt;thr:total&gt;10&lt;/thr:total&gt;</strong>
    &lt;/entry&gt;
    &lt;/entry&gt;
&lt;/feed&gt;
</pre>


<p>
これもやはり補助的な数値なので、正確な数値だと期待してはいけないようです。
</p>


<p>
thr:count, thr:updated, total の数値が正確なものでなくて良い理由については、ドラフトの「6.  Considerations for using thr:count, thr:updated and total」について書かれていますので、ここでは省略します。（書くのめんどくさくなった。）
</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2006/06/25/309/">P Perl と Plagger</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2006-06-25T18:19:00+09:00" pubdate>Jun 25<span>th</span>, 2006</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
<a class="ext-link" href="http://www.amazon.co.jp/exec/obidos/ASIN/0596526741/httshemizorg-22/ref=nosim"><span class="icon"></span>Perl Hacks</a> に載ってた Hack <a class="ticket" href="/ticket/81">#81</a> の <a class="ext-link" href="http://search.cpan.org/dist/PPerl/"><span class="icon"></span>PPerl</a> を plagger で試してみよう、と思ったら <a class="ext-link" href="http://d.hatena.ne.jp/odz/20060524/1148529647"><span class="icon"></span>既に試していらっしゃる方</a> がおりました。
</p>


<p>
というわけで、PPerl が何なのかは <a class="ext-link" href="http://d.hatena.ne.jp/odz/"><span class="icon"></span>id:odz さん</a> の上記エントリを見てください。
</p>


<p>
と、これだけでも何なので、PPerl について気になって調べたことをメモ。まず、global セクションだけ書いた config.yaml で plagger を起動して、ps コマンドで仮想メモリ容量を見てみると、こんな感じになってます。
</p>


<pre class="wiki">
$ pperl plagger                                           [~/plagger]
Plagger [info] plugin Plagger::Plugin::Aggregator::Simple loaded.
$ ps -eo pid,ppid,vsz,args|grep plagger|grep -v grep           [~/plagger]
 6470     1 10772 plagger
 6471  6470 <strong>18592</strong> plagger
 6472  6470 10772 plagger
 6473  6470 10772 plagger
 6474  6470 10772 plagger
 6475  6470 10772 plagger
</pre>


<p>
さらにもう2回ほど pperl plagger を実行すると、
</p>


<pre class="wiki">
$ pperl plagger                                           [~/plagger]
Plagger [info] plugin Plagger::Plugin::Aggregator::Simple loaded.
$ pperl plagger                                           [~/plagger]
Plagger [info] plugin Plagger::Plugin::Aggregator::Simple loaded.
$ ps -eo pid,ppid,vsz,args|grep plagger|grep -v grep           [~/plagger]
 6470     1 10772 plagger
 6471  6470 <strong>18592</strong> plagger
 6472  6470 <strong>18582</strong> plagger
 6473  6470 <strong>18582</strong> plagger
 6474  6470 10772 plagger
 6475  6470 10772 plagger
</pre>


<p>
さらにもう何回か実行してみる。
</p>


<pre class="wiki">
$ ps -eo pid,ppid,vsz,args|grep plagger|grep -v grep      [~/plagger]
 6470     1 10772 plagger
 6471  6470 <strong>18592</strong> plagger
 6472  6470 <strong>18592</strong> plagger
 6473  6470 <strong>18592</strong> plagger
 6474  6470 <strong>18592</strong> plagger
 6475  6470 <strong>18592</strong> plagger
</pre>


<p>
こんな感じで、プロセス ID 6470 が大元の親プロセスになって、他の plagger プロセスをフォークしていて、 親プロセスの仮想メモリ容量が 10772KB、他の子プロセスの仮想メモリ容量との差分である 7820KB が plagger 関連モジュールが確保している仮想メモリ容量なんだろうなぁ、ということが分かります。
</p>


<p>
で、今度は普段使っているコンフィグで起動してみます。
</p>


<pre class="wiki">
$ pperl plagger --config=gmail.yaml
Plagger [info] plugin Plagger::Plugin::Subscription::Bloglines loaded.
Plagger [info] plugin Plagger::Plugin::Subscription::Config loaded.
Plagger [info] plugin Plagger::Plugin::CustomFeed::Simple loaded.
Plagger [info] plugin Plagger::Plugin::CustomFeed::YajiumaWatch loaded.
Plagger [info] plugin Plagger::Plugin::CustomFeed::KotonohaInbox loaded.
Plagger [info] plugin Plagger::Plugin::Filter::EntryFullText loaded.
Plagger [info] plugin Plagger::Plugin::Filter::TruePermalink loaded.
Plagger [info] plugin Plagger::Plugin::Filter::StripRSSAd loaded.
Plagger [info] plugin Plagger::Plugin::Filter::BloglinesContentNormalize loaded.
Plagger [info] plugin Plagger::Plugin::Filter::HatenaDiaryKeywordUnlink loaded.
Plagger [info] plugin Plagger::Plugin::Filter::Rule loaded.
Plagger [info] plugin Plagger::Plugin::Widget::Delicious loaded.
Plagger [info] plugin Plagger::Plugin::Widget::BloglinesSubscription loaded.
Plagger [info] plugin Plagger::Plugin::Publish::Gmail loaded.
... snip ...
$ ps -eo pid,ppid,vsz,args|grep plagger|grep -v grep      [~/plagger]
 6470     1 10772 plagger
 6471  6470 18592 plagger
 6472  6470 18592 plagger
 6473  6470 18592 plagger
 6474  6470 18592 plagger
 6475  6470 <strong>37388</strong> plagger
</pre>


<p>
と、こんな感じで、ID 6475 のプロセスが大きくなってます。これがこのコンフィグで増えた Plagger Plugin モジュールのメモリ容量みたいですね。
</p>


<p>
といったように、pperl を最初に起動した時のモジュールだけをメモリ上に確保するだけではなく、その後新たに読み込まれたモジュールもちゃんとメモリ上に確保してくれているようです。当たり前っちゃ当たり前の気もしますが、何となく気になったので。 
</p>


<p>
他に気になった点として、起動するプロセスの数を増やしたり、制限したりできるのかな、と思ったところ、以下の様なオプションがあるので、この辺りも制御できるようですね。
</p>


<pre class="wiki">
$ pperl --help                                            [~/plagger]
pperl version 0.25
Usage: pperl [options] filename
perl options are passed to your perl executable (see the perlrun man page).
pperl options control the persistent perl behaviour

PPerl Options:
  -k  or --kill      Kill the currently running pperl for that script
  -h  or --help      This page
  --prefork          The number of child processes to prefork (default=5)
  --maxclients       The number of client connections each child
                       will process (default=100)
  -z  or --anyuser   Allow any user (after the first) to access the socket
                       WARNING: This has severe security implications. Use
                       at your own risk
  --no-cleanup       Skip the cleanup stage at the end of running your script
                       this may make your code run faster, but if you forget
                       to close files then they will remain unflushed and unclosed
</pre>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2006/06/20/352/">Text/Trac   Trac Wiki 記法パーサ #2</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2006-06-20T15:07:00+09:00" pubdate>Jun 20<span>th</span>, 2006</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
昨日の時点では実装されていなかった autolink まわりを <a class="ext-link" href="http://d.hatena.ne.jp/drawnboy/"><span class="icon"></span>id:drawnboy さん</a> が実装してくれて、最低限の機能は実装されたかな、という状態になりましたので、とりあえず <a class="ext-link" href="http://search.cpan.org/~mizzy/Text-Trac/"><span class="icon"></span>CPAN に up</a> しました。
</p>


<p>
id:drawnboy さんには autolink まわりだけではなく、他にも色々実装してもらい、大変助かりました。ありがとうございます！
</p>


<p>
Yappo さんご所望の挙動をカスタマイズできる機能は、これから実装をどうするかを含めて検討しますので、もう少しお待ちください。
</p>


<p>
挙動カスタマイズ機能も必要だけど、タグの class 設定とか、リンクの target 設定とかをカスタマイズできるようにもしたい。
</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2006/06/20/384/">Text/Trac   Trac Wiki 記法パーサ #1</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2006-06-20T00:26:00+09:00" pubdate>Jun 20<span>th</span>, 2006</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3 id="Text::Tracをblosxomから呼び出してみるテスト">Text::Trac を blosxom から呼び出してみる テスト</h3>


<p>
Text::Trac が形になってきたので、実際に文章を書いてテストしてみる。
</p>


<h4 id="もういっちょ見出しのテスト">もういっちょ見出しのテスト</h4>


<p>
paragraph 1<br />
paragraph 1<br />
paragraph 1
</p>


<p>
paragraph 2<br />
paragraph 2<br />
paragraph 2
</p>


<ul><li>リスト 1</li>
<li>リスト 2</li>
<li>リスト 3</li></ul>


<ol start="1"><li>リスト 1</li>
<li>リスト 2</li>
<li>リスト 3</li></ol>


<dl>
<dt>定義リスト1</dt>
<dd>
内容その1
</dd>
<dt>定義リスト2</dt>
<dd>
内容その2
</dd>
</dl>


<p>
上の内容は実際にはこんな感じで書いてます。
</p>


<pre class="wiki">
= Text::Trac を blosxom から呼び出してみる テスト =

== もういっちょ見出しのテスト ==

paragraph 1[[BR]]
paragraph 1[[BR]]
paragraph 1

paragraph 2[[BR]]
paragraph 2[[BR]]
paragraph 2

 * リスト 1
 * リスト 2
 * リスト 3

 1. リスト 1
 1. リスト 2
 1. リスト 3

 定義リスト1::
   内容その1
 定義リスト2::
   内容その2
</pre>


<p>
blosxom からは以下の様なプラグインで Text::Trac を呼び出してます。
</p>


<pre class="wiki">
# Blosxom Plugin: text_trac
# Author: Gosuke Miyashita &lt;miya at mizzy.org&gt;
# Version: 2006-06-20
# Blosxom Home/Docs/Licensing: http://www.blosxom.com/

package text_trac;

use strict;
use Text::Trac;

sub start {
  1;
}

sub story {
  my($pkg, $path, $filename, $story_ref, $title_ref, $body_ref) = @_;

  if ( $meta::syntax eq 'trac' ){
      my $parser = Text::Trac-&gt;new( min_heading_level =&gt; 3 );
      $parser-&gt;parse($$body_ref);
      $$body_ref = $parser-&gt;html;
  }

  return 1;
}

1;

__END__
</pre>


<p>
Text::Trac 自体はもうちょいで CPAN にアップできると思います。ただし、Yappo さんご所望の機能はもう少し時間ください。
</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2006/06/17/412/">Text/Trac   Trac Wiki 記法パーサ #0</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2006-06-17T01:11:00+09:00" pubdate>Jun 17<span>th</span>, 2006</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p class="entryBody">
<a href="http://d.hatena.ne.jp/drawnboy/" target="_blank">id:drawnboy</a> さんがつくった <a href="http://d.hatena.ne.jp/drawnboy/20060616/1150384749">Catlxom::Plugin::Format::Hatena</a> を見て、「お、それいい！」と思ったんだけど、そもそも自分ははてダ使っていなくて、この手の記法で唯一使ってるのは <a href="http://projects.edgewall.com/trac/wiki/WikiFormatting" target="_blank">Trac の Wiki 記法</a> なので、Catlxom::Plugin::Format::Trac が欲しいな、と思ったわけですが、Perl のパーサがないんですよね。
</p>




<p class="entryBody">
で、IRC の #catlxom での会話の流れで、自分が <a href="http://trac.mizzy.org/public/browser/library/perl/trunk/Text-Trac" target="_balnk">Text::Trac</a> をつくることになりました。といってもまだつくりかけなので、CPAN にアップするのはまだ先になりそう。とりあえず興味ある方は以下の要領で取得してみてください。
</p>




<pre class="code">
svn co http://svn.mizzy.org/public/library/perl/trunk/Text-Trac
</pre>




<p class="entryBody">
もうほとんど <a href="http://search.cpan.org/~jkondo/Text-Hatena/" target="_blank">Text::Hatena</a> のコードそのまんまです。<a href="http://d.hatena.ne.jp/jkondo/" target="_blank">id:jkondo さん</a> と <a href="http://d.hatena.ne.jp/tociyuki/" target="_blank">id:tociyuki さん</a> に感謝感謝です。 
</p>




<p class="entryBody">
とりあえず
</p>




<pre class="code">
= heading1 =
</pre>




<p class="entryBody">
から
</p>




<pre class="code">
&lt;h1 id="heading1"&gt;heading1&lt;/h1&gt;
</pre>




<p class="entryBody">
への変換のみ実装済み。
</p>




<p class="entryBody">
Text::Hatena と異なる点は、
</p>




<pre class="code">
my $p = Text::Trac-&gt;new(
    custom_notation =&gt; {
        h1node =&gt; '&lt;p&gt;$1&lt;/p&gt;',
    },
);
</pre>




<p class="entryBody">
などと指定すると、
</p>




<pre class="code">
= heading1 =
</pre>




<p class="entryBody">
を
</p>




<pre class="code">
&lt;p&gt;heading1&lt;/p&gt;
</pre>




<p class="entryBody">
と変換する、といった感じで、記法をカスタマイズすることができます。また、
</p>




<pre class="code">
my $p = Text::Trac-&gt;new(
    min_heading_level =&gt; 2,
);
</pre>




<p class="entryBody">
と指定すると、
</p>




<pre class="code">
= heading1 =
</pre>




<p class="entryBody">
が
</p>




<pre class="code">
&lt;h2 id="heading1"&gt;heading1&lt;/h2&gt;
</pre>




<p class="entryBody">
と変換されます。なぜこんな機能をつけたかというと、catlxom プラグインとして使うことを考えた場合、通常 h1 はブログのトップ見出し、h2 はエントリのタイトルに使われるので、エントリの中では h3 以降を使うことになるかと思います。
</p>




<p class="entryBody">
だからといってエントリを書くときにいちいち、「えーと、h3 にしないといけないから、 === hogehoge === だな」とかやるのもうざいので、こんな機能をつけてみました。
</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2006/06/15/413/">Catlxom 本家に Mizzy ブランチができたよ (Catlxom メモ #8)</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2006-06-15T22:12:00+09:00" pubdate>Jun 15<span>th</span>, 2006</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p class="entryBody">
<a href="http://catlxom.org/repos/" target="_blank">catlxom 本家の svn リポジトリ</a> に、<a href="http://catlxom.org/repos/branches/mizzy/catlxom/" target="_blank">mizzy ブランチ</a> ができました。<a href="http://catlxom.org/trac/browser/branches/mizzy/catlxom" target="_blank">trac から見る場合はこちら。</a> <a href="http://catlxom.org/trac" target="_blank">trac トップページ</a> の Authors にも名前いれてもらっちゃいました。typester さん、ありがとうございます！
</p>




<p class="entryBody">
今までこのブログで書いてきた catlxom の修正は、このブランチに反映させてありますので、ご興味のある方は今後こちらからご参照/ご取得ください。
</p>




<p class="entryBody">
微力ながら、catlxom の発展に貢献させてもらえればなぁと思います。
</p>




<p class="entryBody">
次はプラグインづくりに入ろうかと思います。まずは今 blosxom で利用しているプラグインの移植から。本家本元 catlxom のプラグイン機構が今後どうなるかは分かりませんが、そんなに大きく修正しなくても対応できると思うので、今からちまちま作っていきます。
</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2006/06/14/371/">Catlxom の プラグイン機構を Plagger ライクに #2 (Catlxom メモ #7)</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2006-06-14T23:15:00+09:00" pubdate>Jun 14<span>th</span>, 2006</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p class="entryBody">
<a href="http://mizzy.org/program/catlxom_memo_06.html" target="_blank">前回のエントリ</a>で、catlxom のプラグイン機構を plagger っぽくしてみたのですが、
</p>




<pre class="code">
sub register {
    my ($class, $c) = @_;
    $c-&gt;catlxom-&gt;register_hook(
        $class,
        'setup'       =&gt; 'setup',
        'interpolate' =&gt; 'interpolate',
    );
}
</pre>




<p class="entryBody">
といった感じで、各プラグイン毎にいちいちプラグインを実行する hook ポイントと、その hook ポイントで実行するメソッドを記述するのもちょっと冗長だなぁ、と。
</p>




<p class="entryBody">
なので、hook ポイント名とメソッド名は同じ、という規約を作ってしまって、Catalxom::Plugins でプラグインロードする際に register_hook してやれば、いちいち register を書く必要がなくなってハッピーだと思ったのでコード書いてみた。
</p>




<pre class="code">
Index: lib/Catlxom/Plugins.pm
===================================================================
--- lib/Catlxom/Plugins.pm      (revision 23)
+++ lib/Catlxom/Plugins.pm      (working copy)
@@ -51,7 +51,15 @@
         ( my $plugin = 'Catlxom::Plugin::' . join( '::', @path ) . $file-&gt;basename )
             =~ s/\.pm$//;

-        unshift @Catlxom::Context::ISA, $plugin;
+        for ( qw(setup initialize start update filter sort paginate fixedup
+                 interpolate end) ){
+            if ( $plugin-&gt;can($_) ){
+                $c-&gt;catlxom-&gt;register_hook(
+                    $plugin,
+                    $_ =&gt; $_,
+                );
+            }
+        }
     }

     if ( $c-&gt;debug ) {
</pre>




<p class="entryBody">
これでプラグインのコードがちょっとだけすっきりする。<a href="http://mizzy.org/archives/catlxom.patch" target="_blank">本家からの全差分はこちら。</a>
</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2006/06/12/335/">Catlxom の プラグイン機構を Plagger ライクに #1 (Catlxom メモ #6)</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2006-06-12T22:23:00+09:00" pubdate>Jun 12<span>th</span>, 2006</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p class="entryBody">
<a href="http://mizzy.org/program/catlxom_memo_05.html" target="_blank">昨日のエントリ</a>の続き。filter もちゃんと実装して、ついでにプラグインも全て新しいプラグイン機構に対応させてみた。
</p>




<p class="entryBody">
<a href="http://catlxom.org/trac" target="_blank">本家</a> の Rev.23 との全差分です。
</p>




<pre class="code">
Index: plugins/Entry/Blosxom.pm
===================================================================
--- plugins/Entry/Blosxom.pm    (revision 23)
+++ plugins/Entry/Blosxom.pm    (working copy)
@@ -9,6 +9,15 @@
 
 __PACKAGE__-&gt;classdata-&gt;{entries} = [];
 
+sub register {
+    my ($class, $c) = @_;
+    $c-&gt;catlxom-&gt;register_hook(
+        $class,
+        'setup'  =&gt; 'setup',
+        'update' =&gt; 'update',
+    );
+}
+
 sub setup {
     my ( $self, $c ) = @_;
 
@@ -49,15 +58,11 @@
         }
     );
 
-    $self-&gt;entries-&gt;add( __PACKAGE__ );
-
-    $self-&gt;NEXT::setup($c);
+    $c-&gt;catlxom-&gt;entries-&gt;add( __PACKAGE__ );
 }
 
 sub update {
     my ( $self, $c ) = @_;
-
-    $self-&gt;NEXT::update($c);
 }
 
 1;
Index: plugins/Filter/Path.pm
===================================================================
--- plugins/Filter/Path.pm  (revision 23)
+++ plugins/Filter/Path.pm  (working copy)
@@ -4,6 +4,14 @@
 
 our $VERSION = '0.01';
 
+sub register {
+    my ($class, $c) = @_;
+    $c-&gt;catlxom-&gt;register_hook(
+        $class,
+        'filter' =&gt; 'filter',
+    );
+}
+
 sub filter {
     my ( $self, $c, $entry ) = @_;
 
Index: plugins/Filter/Date.pm
===================================================================
--- plugins/Filter/Date.pm  (revision 23)
+++ plugins/Filter/Date.pm  (working copy)
@@ -6,6 +6,14 @@
 
 our $VERSION = '0.01';
 
+sub register {
+    my ($class, $c) = @_;
+    $c-&gt;catlxom-&gt;register_hook(
+        $class,
+        'filter' =&gt; 'filter',
+    );
+}
+
 sub filter {
     my ( $self, $c, $entry ) = @_;
 
Index: plugins/Format/Textile.pm
===================================================================
--- plugins/Format/Textile.pm   (revision 23)
+++ plugins/Format/Textile.pm   (working copy)
@@ -3,29 +3,33 @@
 use warnings;
 use base qw/Catlxom::Plugin/;
 
-use NEXT;
 use Text::Textile;
 
 our $VERSION = '0.01';
 
+sub register {
+    my ($class, $c) = @_;
+    $c-&gt;catlxom-&gt;register_hook(
+        $class,
+        'setup'   =&gt; 'setup',
+        'fixedup' =&gt; 'fixedup',
+    );
+}
+
 sub setup {
     my ( $self, $c ) = @_;
 
     $self-&gt;classdata-&gt;{textile} = Text::Textile-&gt;new;
     $self-&gt;classdata-&gt;{textile}-&gt;charset('utf-8');
-
-    $self-&gt;NEXT::setup($c);
 }
 
 sub fixedup {
     my ( $self, $c ) = @_;
 
-    for my $entry ( @{ $self-&gt;entries-&gt;filtered } ) {
+    for my $entry ( @{ $c-&gt;catlxom-&gt;entries-&gt;filtered } ) {
         $entry-&gt;content(
             $self-&gt;classdata-&gt;{textile}-&gt;process( $entry-&gt;content ) );
     }
-
-    $self-&gt;NEXT::fixedup($c);
 }
 
 1;
Index: plugins/Paginate/Simple.pm
===================================================================
--- plugins/Paginate/Simple.pm  (revision 23)
+++ plugins/Paginate/Simple.pm  (working copy)
@@ -1,27 +1,32 @@
 package Catlxom::Plugin::Paginate::Simple;
 use strict;
 use warnings;
-use NEXT;
 
 use Data::Page;
 use Data::Page::Navigation;
 
 our $VERSION = '0.01';
 
+sub register {
+    my ($class, $c) = @_;
+    $c-&gt;catlxom-&gt;register_hook(
+        $class,
+        'paginate' =&gt; 'paginate',
+    );
+}
+
 sub paginate {
     my ( $self, $c ) = @_;
 
     my $page = int( $c-&gt;req-&gt;params-&gt;{page} || 1 );
     $page = 1 unless $page &gt;= 1;
 
-    my $pager = $self-&gt;stash-&gt;{pager}
-        = Data::Page-&gt;new( scalar @{ $self-&gt;entries },
+    my $pager = $c-&gt;catlxom-&gt;stash-&gt;{pager}
+        = Data::Page-&gt;new( scalar @{ $c-&gt;catlxom-&gt;entries },
         $c-&gt;config-&gt;{num_entries} ||= 20, $page, );
 
-    $self-&gt;entries-&gt;filtered(
-        [ $pager-&gt;splice( $self-&gt;entries-&gt;filtered ) ] );
-
-    $self-&gt;NEXT::paginate($c);
+    $c-&gt;catlxom-&gt;entries-&gt;filtered(
+        [ $pager-&gt;splice( $c-&gt;catlxom-&gt;entries-&gt;filtered ) ] );
 }
 
 1;
Index: plugins/Template/TT.pm
===================================================================
--- plugins/Template/TT.pm  (revision 23)
+++ plugins/Template/TT.pm  (working copy)
@@ -6,19 +6,27 @@
 use Catlxom::Util;
 use List::Util qw/first/;
 use Template;
-use NEXT;
 
 our $VERSION = '0.01';
 
+my $template_dir = Catlxom::Util::load_dir('template');
+my $path_root    = join '/', $template_dir-&gt;dir_list;
+
 __PACKAGE__-&gt;classdata-&gt;{templates} = {};
-__PACKAGE__-&gt;classdata-&gt;{tt}        = Template-&gt;new;
+__PACKAGE__-&gt;classdata-&gt;{tt}        = Template-&gt;new( INCLUDE_PATH =&gt; $path_root );
 
+sub register {
+    my ($class, $c) = @_;
+    $c-&gt;catlxom-&gt;register_hook(
+        $class,
+        'setup'       =&gt; 'setup',
+        'interpolate' =&gt; 'interpolate',
+    );
+}
+
 sub setup {
     my ( $self, $c ) = @_;
 
-    my $template_dir = Catlxom::Util::load_dir('template');
-    my $path_root    = join '/', $template_dir-&gt;dir_list;
-
     $template_dir-&gt;recurse(
         callback =&gt; sub {
             my $file = shift;
@@ -48,8 +56,6 @@
             };
         }
     );
-
-    $self-&gt;NEXT::setup($c);
 }
 
 sub interpolate {
@@ -78,16 +84,14 @@
             \$template-&gt;{template},
             {
                 name =&gt; $c-&gt;config-&gt;{name},
-                %{ $self-&gt;stashall },
-                entries =&gt; $self-&gt;entries-&gt;filtered,
+                %{ $c-&gt;catlxom-&gt;stashall },
+                entries =&gt; $c-&gt;catlxom-&gt;entries-&gt;filtered,
 
                 c =&gt; $c,
             },
             \$c-&gt;res-&gt;{body},
-        );
+        ) or $c-&gt;error( $self-&gt;classdata-&gt;{tt}-&gt;error );
     }
-
-    $self-&gt;NEXT::interpolate($c);
 }
 
 1;
Index: lib/Catlxom/Context/Base.pm
===================================================================
--- lib/Catlxom/Context/Base.pm (revision 23)
+++ lib/Catlxom/Context/Base.pm (working copy)
@@ -5,7 +5,6 @@
 
 use Catlxom::Plugins;
 use Catlxom::Entries;
-use NEXT;
 
 __PACKAGE__-&gt;mk_classdata( plugin  =&gt; Catlxom::Plugins-&gt;new );
 __PACKAGE__-&gt;mk_classdata( entries =&gt; Catlxom::Entries-&gt;new );
@@ -14,50 +13,56 @@
 
 sub setup {
     my ($self, $c) = @_;
+    $self-&gt;plugin-&gt;load($c);
+    $self-&gt;run_hook($c, 'setup');
+}
 
-    $self-&gt;plugin-&gt;load($c);
-    {
-        # plugin setup
-        no warnings 'redefine';
-        local *setup = sub { };
-        $self-&gt;setup($c);
+sub register_hook {
+    my ($self, $plugin, @hooks) = @_;
+    while (my($hook, $callback) = splice @hooks, 0, 2) {
+        push @{ $self-&gt;{hooks}-&gt;{$hook} }, {
+            callback  =&gt; $callback,
+            plugin    =&gt; $plugin,
+        };
     }
 }
 
-sub initialize {
-    my ( $self, $c ) = @_;
-
-    $self-&gt;_stash( {} );
+sub run_hook {
+    my($self, $c, $hook, $args) = @_;
+    for my $action (@{ $self-&gt;{hooks}-&gt;{$hook} }) {
+        my $plugin   = $action-&gt;{plugin};
+        my $callback = $action-&gt;{callback};
+        no strict 'refs';
+        $plugin-&gt;$callback($c, $args);
+    }
 }
 
-sub start       { }
-sub update      { }
-sub sort        { }
-sub paginate    { }
-sub fixedup     { }
-sub interpolate { }
-sub end         { }
-
 sub dispatch {
     my ( $self, $c ) = @_;
 
-    $self-&gt;initialize($c);
+    $self-&gt;_stash( {} );
+    $self-&gt;run_hook($c, 'initialize');
 
-    $self-&gt;start($c);
-    $self-&gt;update($c);
+    $self-&gt;run_hook($c, 'start');
+    $self-&gt;run_hook($c, 'update');
 
-    $self-&gt;entries-&gt;filter($c);
-    $self-&gt;sort($c);
-    $self-&gt;paginate($c);
+    $self-&gt;entries-&gt;filtered( [] );
+    for my $entry ( @{ $self-&gt;entries } ){
+        $self-&gt;run_hook($c, 'filter', $entry);
+        push @{ $self-&gt;entries-&gt;filtered }, $entry-&gt;clone;
+    }
+    $self-&gt;run_hook($c, 'sort');
+    $self-&gt;run_hook($c, 'paginate');
 
-    $self-&gt;fixedup($c);
-    $self-&gt;interpolate($c);
-    $self-&gt;end($c);
+    $self-&gt;run_hook($c, 'fixedup');
+    $self-&gt;run_hook($c, 'interpolate');
+    $self-&gt;run_hook($c, 'end');
 }
 
 sub stash {
     my $self   = shift;
-    my $caller = caller(0);
+    ( my $caller = lc caller(0) ) =~ s/Catlxom::Plugin:://i;
+    $caller =~ s/::/_/g;
 
     if (@_) {
         my $stash = @_ &gt; 1 ? {@_} : $_[0];
Index: lib/Catlxom/Entries.pm
===================================================================
--- lib/Catlxom/Entries.pm  (revision 23)
+++ lib/Catlxom/Entries.pm  (working copy)
@@ -4,7 +4,6 @@
 use base qw/Class::Accessor::Fast Class::Data::Inheritable/;
 
 use Catalyst::Exception;
-use NEXT;
 
 use Catlxom::Entry;
 
@@ -30,21 +29,4 @@
     \@entries;
 }
 
-sub filter {
-    my ( $self, $c ) = @_;
-
-    $self-&gt;filtered( [] );
-
-    my @plugins = grep { $_-&gt;can('filter') } @{ $c-&gt;catlxom-&gt;plugin };
-
-FILTER:
-    for my $entry ( @{ $self-&gt;entries } ) {
-        for my $plugin (@plugins) {
-            next FILTER unless $plugin-&gt;filter( $c, $entry );
-        }
-        push @{ $self-&gt;filtered }, $entry-&gt;clone;
-    }
-}
-
 1;
-
Index: lib/Catlxom/Plugins.pm
===================================================================
--- lib/Catlxom/Plugins.pm  (revision 23)
+++ lib/Catlxom/Plugins.pm  (working copy)
@@ -51,7 +51,7 @@
         ( my $plugin = 'Catlxom::Plugin::' . join( '::', @path ) . $file-&gt;basename )
             =~ s/\.pm$//;
 
-        unshift @Catlxom::Context::ISA, $plugin;
+        $plugin-&gt;register($c);
     }
 
     if ( $c-&gt;debug ) {
</pre>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/26/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/24/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/03/31/puppet-report-ikachan/">puppet-report-ikachan</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/03/07/image-with-exif-tag-plugin/">Image with EXIF tag plugin</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/03/07/exif-tag-plugin/">EXIF tag plugin</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/03/04/rakuten-tag-plugin/">Rakuten tag plugin for Jekyll</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/02/29/paperboys-engineer-evaluation-system/">Paperboy&#8217;s engineer evaluation system</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Coderwall</h1>
  <p>
  <script type="text/javascript">
    function display_coderwall(args) {
        var badges = args["data"]["badges"];
        for ( var i = 0; i < badges.length; i++ ) {
            document.write('<img src="'+ badges[i]["badge"] + '" width="48" height="48" />');
        }
    }
  </script>
  <script src="http://coderwall.com/mizzy.json?callback=display_coderwall"></script>
  </p>
  <p style="text-align: right;"><a href="http://coderwall.com/mizzy">Powered by coderwall.com</a></p>
</section>


<section>
  <h1>Github Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/mizzy">@mizzy</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'mizzy',
            count: 30,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>




  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Gosuke Miyashita -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'mizzyorg';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
