
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Gosuke Miyashita</title>
  <meta name="author" content="Gosuke Miyashita">

  
  <meta name="description" content="ustream の FLV をダウンロードして音声変換する方法は、&#8221;typesterさんのとこに詳しく書いてある&#8221;:http://unknownplace.org/memo/2007/10/03 わけですが、sox に渡すときにサンプルレートを指定する必要があったりします &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://mizzy.org/blog/page/13">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Gosuke Miyashita" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-53984-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Gosuke Miyashita</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:mizzy.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/10/08/529/">Flv/Info で Ustream の Flv ファイル情報をとろうとするとエラーになる件</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2007-10-08T14:07:00+09:00" pubdate>Oct 8<span>th</span>, 2007</time>
        
         | <a href="/blog/2007/10/08/529/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>ustream の FLV をダウンロードして音声変換する方法は、&#8221;typesterさんのとこに詳しく書いてある&#8221;:http://unknownplace.org/memo/2007/10/03 わけですが、sox に渡すときにサンプルレートを指定する必要があったりします。</p>

<p>で、これを Plagger プラグインで実現するためには、何らかの方法で元ファイルのサンプルレートを取得しないといけないわけで、&#8221;FLV::Info&#8221;:http://search.cpan.org/dist/FLV-Info/ でできそうだな、と思ったところ</p>

<pre><code>Failed to read FLV file: Tag size is too small (0) at byte 193 (0xc1) at /usr/local/lib/perl5/site_perl/5.8.7/FLV/Tag.pm line 81.
</code></pre>


<p>といったエラーが出ます。色々調べてみたところ、ustream の FLV ファイル中に、ボディが 0 のオーディオタグが存在するから、ということがわかったので、&#8221;パッチを書いて RT に投げておきました。&#8221;:https://rt.cpan.org/Ticket/Display.html?id=29831</p>

<p>パッチ自体は数行コメントアウトして1行追加しただけ、という簡単なものなのですが、このパッチを書くために、&#8221;FLVのファイルフォーマット&#8221;:http://osflash.org/flv を調べて、音声フォーマットを取得する Perl スクリプトを自分で書いてみたりと、えらく回り道しました。せっかくなんでスクリプトを載せておきます。スクリプト作成にあたって、<a href="http://code.google.com/p/nelly2pcm/">nelly2pcm</a> のソースも参考にしています。</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="c1">#!/usr/bin/perl</span>
</span><span class='line'>
</span><span class='line'><span class="k">use</span> <span class="n">strict</span><span class="p">;</span>
</span><span class='line'><span class="k">use</span> <span class="n">warnings</span><span class="p">;</span>
</span><span class='line'><span class="k">use</span> <span class="n">Readonly</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">Readonly</span> <span class="k">my</span> <span class="nv">$FLV_TAG_TYPE_AUDIO</span>                <span class="o">=&gt;</span> <span class="mh">0x08</span><span class="p">;</span>
</span><span class='line'><span class="n">Readonly</span> <span class="k">my</span> <span class="nv">$AUDIO_MASK_STEREO</span>                 <span class="o">=&gt;</span> <span class="mh">0x01</span><span class="p">;</span>
</span><span class='line'><span class="n">Readonly</span> <span class="k">my</span> <span class="nv">$AUDIO_MASK_16bit</span>                  <span class="o">=&gt;</span> <span class="mh">0x02</span><span class="p">;</span>
</span><span class='line'><span class="n">Readonly</span> <span class="k">my</span> <span class="nv">$AUDIO_MASK_RATE</span>                   <span class="o">=&gt;</span> <span class="mh">0x0c</span><span class="p">;</span>
</span><span class='line'><span class="n">Readonly</span> <span class="k">my</span> <span class="nv">$AUDIO_RATE_5point5KHZ</span>             <span class="o">=&gt;</span> <span class="mh">0x00</span><span class="p">;</span>
</span><span class='line'><span class="n">Readonly</span> <span class="k">my</span> <span class="nv">$AUDIO_RATE_11KHZ</span>                  <span class="o">=&gt;</span> <span class="mh">0x04</span><span class="p">;</span>
</span><span class='line'><span class="n">Readonly</span> <span class="k">my</span> <span class="nv">$AUDIO_RATE_22KHZ</span>                  <span class="o">=&gt;</span> <span class="mh">0x08</span><span class="p">;</span>
</span><span class='line'><span class="n">Readonly</span> <span class="k">my</span> <span class="nv">$AUDIO_RATE_44KHZ</span>                  <span class="o">=&gt;</span> <span class="mh">0x0c</span><span class="p">;</span>
</span><span class='line'><span class="n">Readonly</span> <span class="k">my</span> <span class="nv">$AUDIO_MASK_FORMAT</span>                 <span class="o">=&gt;</span> <span class="mh">0xf0</span><span class="p">;</span>
</span><span class='line'><span class="n">Readonly</span> <span class="k">my</span> <span class="nv">$AUDIO_FORMAT_UNCOMPRESSED</span>         <span class="o">=&gt;</span> <span class="mh">0x00</span><span class="p">;</span>
</span><span class='line'><span class="n">Readonly</span> <span class="k">my</span> <span class="nv">$AUDIO_FORMAT_ADPCM</span>                <span class="o">=&gt;</span> <span class="mh">0x10</span><span class="p">;</span>
</span><span class='line'><span class="n">Readonly</span> <span class="k">my</span> <span class="nv">$AUDIO_FORMAT_MP3</span>                  <span class="o">=&gt;</span> <span class="mh">0x20</span><span class="p">;</span>
</span><span class='line'><span class="n">Readonly</span> <span class="k">my</span> <span class="nv">$AUDIO_FORMAT_NELLYMOSER_8KHZ_MONO</span> <span class="o">=&gt;</span> <span class="mh">0x50</span><span class="p">;</span>
</span><span class='line'><span class="n">Readonly</span> <span class="k">my</span> <span class="nv">$AUDIO_FORMAT_NELLYMOSER</span>           <span class="o">=&gt;</span> <span class="mh">0x60</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">Readonly</span> <span class="k">my</span> <span class="nv">%AUDIO_RATE</span> <span class="o">=&gt;</span> <span class="p">(</span>
</span><span class='line'>    <span class="nv">$AUDIO_RATE_5point5KHZ</span> <span class="o">=&gt;</span> <span class="mf">5.5</span><span class="p">,</span>
</span><span class='line'>    <span class="nv">$AUDIO_RATE_11KHZ</span>      <span class="o">=&gt;</span> <span class="mi">11</span><span class="p">,</span>
</span><span class='line'>    <span class="nv">$AUDIO_RATE_22KHZ</span>      <span class="o">=&gt;</span> <span class="mi">22</span><span class="p">,</span>
</span><span class='line'>    <span class="nv">$AUDIO_RATE_44KHZ</span>      <span class="o">=&gt;</span> <span class="mi">44</span><span class="p">,</span>
</span><span class='line'><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="n">Readonly</span> <span class="k">my</span> <span class="nv">%AUDIO_FORMAT</span> <span class="o">=&gt;</span> <span class="p">(</span>
</span><span class='line'>    <span class="nv">$AUDIO_FORMAT_UNCOMPRESSED</span>         <span class="o">=&gt;</span> <span class="s">&#39;Uncompressed&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nv">$AUDIO_FORMAT_ADPCM</span>                <span class="o">=&gt;</span> <span class="s">&#39;ADPCM&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nv">$AUDIO_FORMAT_MP3</span>                  <span class="o">=&gt;</span> <span class="s">&#39;MP3&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nv">$AUDIO_FORMAT_NELLYMOSER_8KHZ_MONO</span> <span class="o">=&gt;</span> <span class="s">&#39;Nellymoser 8kHz mono&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nv">$AUDIO_FORMAT_NELLYMOSER</span>           <span class="o">=&gt;</span> <span class="s">&#39;Nellymoser&#39;</span><span class="p">,</span>
</span><span class='line'><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">my</span> <span class="nv">$file</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nb">open</span> <span class="k">my</span> <span class="nv">$fh</span><span class="p">,</span> <span class="s">&#39;&lt;&#39;</span><span class="p">,</span> <span class="nv">$file</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">my</span> <span class="nv">$header</span> <span class="o">=</span> <span class="n">read_header</span><span class="p">(</span><span class="nv">$fh</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">while</span> <span class="p">(</span> <span class="o">!</span> <span class="nb">eof</span> <span class="nv">$fh</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">my</span> <span class="nv">$tag</span> <span class="o">=</span> <span class="n">read_tag</span><span class="p">(</span><span class="nv">$fh</span><span class="p">);</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span> <span class="nv">$tag</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">type</span><span class="p">}</span> <span class="o">==</span> <span class="nv">$FLV_TAG_TYPE_AUDIO</span> <span class="ow">and</span> <span class="nv">$tag</span><span class="o">-&gt;</span><span class="p">{</span><span class="nb">length</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">my</span> <span class="nv">$first_byte</span> <span class="o">=</span> <span class="nv">$tag</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">first_byte</span><span class="p">};</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="k">my</span> <span class="nv">$stereo</span>       <span class="o">=</span> <span class="nv">$first_byte</span> <span class="o">&amp;</span> <span class="nv">$AUDIO_MASK_STEREO</span><span class="p">;</span>
</span><span class='line'>  <span class="k">my</span> <span class="nv">$audio_size</span>  <span class="o">=</span> <span class="nv">$first_byte</span> <span class="o">&amp;</span> <span class="nv">$AUDIO_MASK_16bit</span> <span class="p">?</span> <span class="mi">16</span> <span class="p">:</span> <span class="mi">8</span><span class="p">;</span>
</span><span class='line'>        <span class="k">my</span> <span class="nv">$audio_rate</span>   <span class="o">=</span> <span class="nv">$AUDIO_RATE</span><span class="p">{</span> <span class="nv">$first_byte</span> <span class="o">&amp;</span> <span class="nv">$AUDIO_MASK_RATE</span> <span class="p">}</span> <span class="o">||</span> <span class="s">&#39;unknown&#39;</span><span class="p">;</span>
</span><span class='line'>        <span class="k">my</span> <span class="nv">$audio_format</span> <span class="o">=</span> <span class="nv">$AUDIO_FORMAT</span><span class="p">{</span> <span class="nv">$first_byte</span> <span class="o">&amp;</span> <span class="nv">$AUDIO_MASK_FORMAT</span> <span class="p">}</span> <span class="o">||</span> <span class="s">&#39;unknown&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">print</span> <span class="s">&#39;audio type: &#39;</span> <span class="o">.</span> <span class="p">(</span> <span class="nv">$stereo</span> <span class="p">?</span> <span class="s">&#39;stereo&#39;</span> <span class="p">:</span> <span class="s">&#39;mono&#39;</span> <span class="p">)</span> <span class="o">.</span> <span class="s">&quot;\n&quot;</span><span class="p">;</span>
</span><span class='line'>        <span class="k">print</span> <span class="s">&quot;audio size: $audio_size bit\n&quot;</span><span class="p">;</span>
</span><span class='line'>        <span class="k">print</span> <span class="s">&quot;audio rate: $audio_rate Hz\n&quot;</span><span class="p">;</span>
</span><span class='line'>        <span class="k">print</span> <span class="s">&quot;audio format: $audio_format\n&quot;</span><span class="p">;</span>
</span><span class='line'>        <span class="k">last</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">sub </span><span class="nf">read_header</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">my</span> <span class="nv">$fh</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span>
</span><span class='line'>    <span class="nb">read</span> <span class="nv">$fh</span><span class="p">,</span> <span class="k">my</span> <span class="nv">$sig</span><span class="p">,</span>       <span class="mi">3</span><span class="p">;</span>
</span><span class='line'>    <span class="nb">read</span> <span class="nv">$fh</span><span class="p">,</span> <span class="k">my</span> <span class="nv">$version</span><span class="p">,</span>   <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>    <span class="nb">read</span> <span class="nv">$fh</span><span class="p">,</span> <span class="k">my</span> <span class="nv">$flag</span><span class="p">,</span>      <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>    <span class="nb">read</span> <span class="nv">$fh</span><span class="p">,</span> <span class="k">my</span> <span class="nv">$offset</span><span class="p">,</span>    <span class="mi">4</span><span class="p">;</span>
</span><span class='line'>    <span class="nb">read</span> <span class="nv">$fh</span><span class="p">,</span> <span class="k">my</span> <span class="nv">$prev_tag</span><span class="p">,</span>  <span class="mi">4</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">sig</span> <span class="o">=&gt;</span> <span class="nv">$sig</span><span class="p">,</span>
</span><span class='line'>        <span class="n">version</span> <span class="o">=&gt;</span> <span class="nb">unpack</span><span class="p">(</span><span class="s">&#39;H*&#39;</span><span class="p">,</span> <span class="nv">$version</span><span class="p">),</span>
</span><span class='line'>        <span class="n">flag</span>    <span class="o">=&gt;</span> <span class="nb">unpack</span><span class="p">(</span><span class="s">&#39;H*&#39;</span><span class="p">,</span> <span class="nv">$flag</span><span class="p">),</span>
</span><span class='line'>        <span class="n">offset</span>  <span class="o">=&gt;</span> <span class="nb">unpack</span><span class="p">(</span><span class="s">&#39;H*&#39;</span><span class="p">,</span> <span class="nv">$offset</span><span class="p">),</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">sub </span><span class="nf">read_tag</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">my</span> <span class="nv">$fh</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span>
</span><span class='line'>    <span class="nb">read</span> <span class="nv">$fh</span><span class="p">,</span> <span class="k">my</span> <span class="nv">$type</span><span class="p">,</span>               <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>    <span class="nb">read</span> <span class="nv">$fh</span><span class="p">,</span> <span class="k">my</span> <span class="nv">$length</span><span class="p">,</span>             <span class="mi">3</span><span class="p">;</span>
</span><span class='line'>    <span class="nb">read</span> <span class="nv">$fh</span><span class="p">,</span> <span class="k">my</span> <span class="nv">$timestamp</span><span class="p">,</span>          <span class="mi">3</span><span class="p">;</span>
</span><span class='line'>    <span class="nb">read</span> <span class="nv">$fh</span><span class="p">,</span> <span class="k">my</span> <span class="nv">$timestamp_extended</span><span class="p">,</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>    <span class="nb">read</span> <span class="nv">$fh</span><span class="p">,</span> <span class="k">my</span> <span class="nv">$stream_id</span><span class="p">,</span>          <span class="mi">3</span><span class="p">;</span>
</span><span class='line'>    <span class="nb">read</span> <span class="nv">$fh</span><span class="p">,</span> <span class="k">my</span> <span class="nv">$first_byte</span><span class="p">,</span>         <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">my</span> <span class="nv">$pos</span> <span class="o">=</span> <span class="nb">hex</span> <span class="nb">unpack</span> <span class="s">&#39;H*&#39;</span><span class="p">,</span> <span class="nv">$length</span><span class="p">;</span>
</span><span class='line'>    <span class="nb">seek</span> <span class="nv">$fh</span><span class="p">,</span> <span class="nv">$pos</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nb">read</span> <span class="nv">$fh</span><span class="p">,</span> <span class="k">my</span> <span class="nv">$prev_tag</span><span class="p">,</span>  <span class="mi">4</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">type</span>       <span class="o">=&gt;</span> <span class="nb">unpack</span><span class="p">(</span><span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="nv">$type</span><span class="p">),</span>
</span><span class='line'>        <span class="nb">length</span>     <span class="o">=&gt;</span> <span class="nv">$pos</span><span class="p">,</span>
</span><span class='line'>        <span class="n">first_byte</span> <span class="o">=&gt;</span> <span class="nb">unpack</span><span class="p">(</span><span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="nv">$first_byte</span><span class="p">),</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>こんな感じで FLV ファイルの音声情報を表示します。</p>

<pre><code>$ ./get_flv_info.pl broadcast_35957_1191232400660.flv
audio type: mono
audio size: 16 bit
audio rate: 11 Hz
audio format: Nellymoser  
</code></pre>


<p>あとは Plagger プラグインを書くだけ、という感じなのですが、リビドーが沸いてこないのでちょっと保留。FFmpeg で Nellymoser に対応する予定がある（既に SVN HEAD には Nellymoser という文字列がコード中にある）ようなので、それまで待ってもいいかなー、と。</p>

<p>音声変換するプラグイン &#8220;Filter::Audio&#8221;:http://coderepos.org/share/browser/lang/perl/plagger/lib/Plagger/Plugin/Filter/Audio.pm は coderepos にあげてありますので、俺が対応してやるぜ、という方はお好きなようにいじってください。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/10/01/528/">Shibuya.Pm テクニカルトーク #8 でしゃべってきました</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2007-10-01T23:18:00+09:00" pubdate>Oct 1<span>st</span>, 2007</time>
        
         | <a href="/blog/2007/10/01/528/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>プレゼン途中にバッテリーが切れるという失態をやらかしたため、yusukebeさん言うところの「お口で」のみのプレゼンとなってしまいました。ごめんなさい。<a href="http://mizzy.org/archives/2007/pushmi_shibuya_pm_8.pdf">会場でお見せできなかった幻の資料はこちらにアップしておきます</a>。</p>

<p>Thinkpad X60sはバッテリー残量表示が1時間になっていても、プレゼンやると2,3分でバッテリー切れますので、みなさんご注意下さい。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/08/30/524/">Puppet Mode.El のパッチ</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2007-08-30T00:30:00+09:00" pubdate>Aug 30<span>th</span>, 2007</time>
        
         | <a href="/blog/2007/08/30/524/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Puppet で同じタイプのリソースを大量に記述する時には、</p>

<pre><code>package { sudo:
  ensure => latest
}

package { ntp:
  ensure => latest
}

package { ssh:
  ensure => latest
}
</code></pre>


<p>なんて書くのはだるいので、</p>

<pre><code>package {
  sudo:
    ensure => latest;
  ntp:
    ensure => latest;
  ssh:
    ensure => latest;
}
</code></pre>


<p>と書きたいのですが、Emacs + &#8220;puppet-mode.el&#8221;:https://reductivelabs.com/svn/puppet/trunk/ext/emacs/puppet-mode.el では、後者みたいな書き方だと、インデントが意図した通りにならなくて、イラっときてパッチ書いた。</p>

<pre><code>=== puppet-mode.el
==================================================================
--- puppet-mode.el      (revision 1800)
+++ puppet-mode.el      (local)
@@ -106,7 +106,9 @@
                  (progn
                     (setq cur-indent (- (current-indentation) 2))
                    (setq not-indented nil))
-               (setq cur-indent (- (current-indentation) 2))))
+               (setq cur-indent (- (current-indentation) 2)))
+              (if (looking-at "^.*;")
+                  (setq cur-indent (- cur-indent 2))))
            (if (< cur-indent 0)     ; We can't indent past the left margin
                (setq cur-indent 0)))
        (save-excursion
@@ -125,6 +127,18 @@
                    (setq cur-indent (+ (current-indentation) 2))
                    (setq not-indented nil))
                (if (bobp)
+                   (setq not-indented nil)))
+             (if (looking-at "^.*:\s*$")
+                 (progn
+                   (setq cur-indent (+ (current-indentation) 2))
+                   (setq not-indented nil))
+               (if (bobp)
+                   (setq not-indented nil)))
+             (if (looking-at "^.*;")
+                 (progn
+                    (setq cur-indent (- (current-indentation) 2))
+                   (setq not-indented nil))
+               (if (bobp)
                    (setq not-indented nil)))))))
       (if cur-indent
          (indent-line-to cur-indent) 
</code></pre>


<p>他にもインデントまわりの動作で微妙なところはあるけど、ちょっとはましになった。インデントまわりの処理で参考になる emacs-lisp って何かないかな？</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/08/09/521/">Trac の Search Hyper Estraier Plugin を Trac 0.10.X で動かすパッチ</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2007-08-09T03:03:00+09:00" pubdate>Aug 9<span>th</span>, 2007</time>
        
         | <a href="/blog/2007/08/09/521/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>&#8220;SearchHyperEstraierPlugin&#8221;:http://weekbuild.sakura.ne.jp/trac/wiki/TracDoc/SearchHyperEstraierPlugin が、Trac 0.10.x というか、うちの環境で動かないので、パッチ書いた。初 Python プログラミング。（というほどのものじゃないけど。）</p>

<pre><code>
=== searchhyperestraier/searchhyperestraier.py
==================================================================
--- searchhyperestraier/searchhyperestraier.py  (revision 892)
+++ searchhyperestraier/searchhyperestraier.py  (local)
@@ -2,8 +2,9 @@
 # SearchRepositoryWithNamazu plugin

 from trac.core import *
-from trac.Search import ISearchSource, query_to_sql, shorten_result
+from trac.Search import ISearchSource, shorten_result
 from trac.util import NaivePopen
+from trac.util.text import to_unicode
 from StringIO import StringIO
 import urllib
 import time
@@ -44,9 +45,9 @@
         browse_trac = self.env.config.get('searchhyperestraier', 'browse_trac','enabled')
 
 
-        cmdline = "%s %s %s %s" % (estcmd_path,estcmd_arg,index_path,unicode(query,'utf-8').encode(estcmd_encode))
+        cmdline = "%s %s %s %s" % (estcmd_path,estcmd_arg,index_path,' '.join(query))
         self.log.debug('SearchHyperEstraier:%s' % cmdline)
-        np = NaivePopen(cmdline)
+        np = NaivePopen( cmdline.encode(estcmd_encode) )
         #self.log.debug('Result:%s' % unicode(np.out,'utf-8').encode('mbcs'))
         #self.log.debug('Result:%s' % np.out)
         if np.errorlevel or np.err:
@@ -74,7 +75,7 @@
             attrelem_array = element.getElementsByTagName("attribute")
             for attrelem in attrelem_array:
                 attr_name = attrelem.getAttribute("name")
-                attr_value = unicode(attrelem.getAttribute("value")).encode('utf-8')
+                attr_value = to_unicode(attrelem.getAttribute("value"))
                 #URLとタイトルを生成
                 if attr_name == "_lreal":
                     attr_value=attr_value[len(replace_left):].replace("\\","/")
</code></pre>


<p>エラーが出るたびに、適当にいじってたら動いた、という感じ。なので、こんなんでいいのかはよく分からない。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/08/03/520/">Pushmi つかってます & 技術者募集中 At 福岡</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2007-08-03T01:52:00+09:00" pubdate>Aug 3<span>rd</span>, 2007</time>
        
         | <a href="/blog/2007/08/03/520/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>&#8220;弊社&#8221;:http://www.paperboy.co.jp/ は東京と福岡にオフィスがあり、それぞれの拠点に Subversion + Trac 環境を構築し、&#8221;OpenVPN&#8221;:http://openvpn.net/ により VPN 接続してお互いの開発状況を公開しています。サービス絡みの開発は基本的に、東京は東京、福岡は福岡で完結しているので、この方式で問題はないのですが、サーバ管理関連のスクリプトなんかは、東京と福岡で共通するものが多いため、別々の SVN リポジトリで管理されてると不便なんですよね。かといって、どちらかの拠点だけしかリポジトリがないと、VPN の障害発生時に、リポジトリのない拠点からはまったくアクセスができない、という困ったことになってしまいます。</p>

<p>そこで、SVN リポジトリレプリケーションツール &#8220;Pushmi&#8221;:http://search.cpan.org/dist/Pushmi/lib/Pushmi.pm を導入してみました。詳細は &#8220;YAPC::Asia での 作者 Cl Kao によるスピーチ動画&#8221;:http://video.google.com/videoplay?docid=-7181301487103062288&amp;q=yapc+asia+2007&amp;total=46&amp;start=0&amp;num=50&amp;so=1&amp;type=search&amp;plindex=13 を見て頂くとして、ここでは行った設定についてメモを残しておきます。ほとんど perldoc Pushmi の内容と同じですが。</p>

<p>まず当然 Pushmi のインストールが必要です。これの手順は省略。また、より良いアトミックロック実現のために &#8220;memcached&#8221;:http://www.danga.com/memcached/ を利用している、ということなのでインストールしておきます。これも手順は省略。</p>

<p>memcached を起動します。</p>

<pre><code>$ sudo /usr/bin/memcached -p 8123 -dP /var/run/memcached.pid -u nobody
</code></pre>


<p>/etc/pushmi.conf を設定します。弊社の環境では memcached のポートのみ指定してます。</p>

<pre><code>authproxy_port: 8123
</code></pre>


<p>ミラーリポジトリを作成します。</p>

<pre><code>$ pushmi mirror /var/db/my-local-mirror http://master.repository/svn
Mirror initialized.
</code></pre>


<p>ミラーリポジトリとマスターリポジトリを同期します。</p>

<pre><code>$ pushmi sync /var/db/my-local-mirror
Retrieving log information from 1 to 62
</code></pre>


<p>ミラーリポジトリは、svnadmin create で作成するのと同様なディレクトリ、ファイル構造になってますが、Pushmi 用の pre-commit スクリプトと post-commit スクリプトが置かれている、というところが異なります。</p>

<p>pre-commit では以下の様なコマンドが実行され、ミラーリポジトリにコミットされた内容を、マスターリポジトリにコミットしに行きます。</p>

<pre><code>/usr/bin/pushmi runhook $1 --txnname $2
</code></pre>


<p>post-commit では以下の様なコマンドが実行され、ミラーとマスターの整合性を確認しています。</p>

<pre><code>/usr/bin/pushmi verify $1 --revision $2
</code></pre>


<p>Apache + WebDAV で SVN リポジトリにアクセスするために、以下の様な設定を Apache で行います。</p>

<pre><code><Location /svn/server>
  PerlSetVar SVNPath /var/db/my-local-mirror
  PerlSetVar Pushmi /usr/bin/pushmi
  PerlSetVar PushmiConfig /etc/pushmi.conf
  <LimitExcept GET PROPFIND OPTIONS REPORT>
    AuthName "mirrored private area"
    AuthType Basic
    Require valid-user
    AuthLDAPURL ldap://localhost:389/ou=people,o=paperboy?uid?sub?(objectclass=*)
    PerlAuthenHandler Pushmi::Apache::AuthCommit
  </LimitExcept>
</Location>
</code></pre>


<p>設定見て分かると思いますが、mod_perl を利用していて、Apche2 + mod_perl の環境が必要です。Apache は 2.0 系でも 2.2 系でも大丈夫なようです。弊社では 2.0 系を利用しています。</p>

<p>特にポイントとなるのは、</p>

<pre><code>PerlAuthenHandler Pushmi::Apache::AuthCommit
</code></pre>


<p>の部分で、認証で渡されたユーザ名、パスワードをこのモジュールで memcached にキャッシュしておき、マスタリポジトリへのコミット時の認証に利用します。Apache 2.2 系の場合には、以下の様に設定します。</p>

<pre><code>AuthBasicProvider Pushmi::Apache::RelayProvider
</code></pre>


<p>この状態では、ミラーへのコミットは即マスターに反映されますが、マスターへのコミットはミラーに反映されませんので、以下の様な cron 設定を行い、5分おきにマスターとミラーを同期するようにします。</p>

<pre><code>*/5 * * * * /usr/bin/pushmi sync --nowait /var/db/my-local-mirror
</code></pre>


<p>今のところこれで問題なく動いています。</p>

<p>話変わりまして、弊社福岡支社では、&#8221;プログラマ&#8221;:http://tenshoku.mynavi.jp/jobset/index.cfm?fuseaction=mrjt_Jobinfo_form&amp;client_id=87984&amp;plan_id=1&amp;contract_id=1&amp;job_seq_no=1&amp;ty=0&amp;rm=0 と &#8220;サーバエンジニア&#8221;:http://tenshoku.mynavi.jp/jobset/index.cfm?fuseaction=mrjt_Jobinfo_form&amp;client_id=87984&amp;plan_id=1&amp;contract_id=1&amp;job_seq_no=2&amp;ty=0&amp;rm=0 を募集しています。Pushmi を実戦で使ってみたい！という方はぜひ。メガネ女子プログラマもいますよ。（東京本社にもいます。人妻ですが。）</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/07/26/519/">Mod Dosdetector を Apache 2.0 系で動かすパッチ</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2007-07-26T22:32:00+09:00" pubdate>Jul 26<span>th</span>, 2007</time>
        
         | <a href="/blog/2007/07/26/519/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>&#8220;mod_dosdetecter 0.2&#8221;:http://sourceforge.net/projects/moddosdetector/ を Apache 2.0 系で動かすパッチを書いてみた。修正ポイントは、</p>

<ul>
<li>/usr/local/apache/include/pcreposix.h:41: error: redeclaration of enumerator `REG_BADBR&#8217; といったエラーが大量に出てくるが、これは /usr/include/regex.h と宣言が重複しているため。なので、#include &lt;regex.h&gt; は削除。</li>
<li>ap_regmatch_t 構造体と ap_regex_t 構造体は 2.2 系にのみ存在し、2.0 系には存在しない。なのでそれぞれ、regmatch_t, regex_t に置き換える。</li>
<li>apr_shm_remove は 2.2系 でしか使えないので、そのための修正を &#8220;mod_fcgid のソース&#8221;:http://mod-fcgid.cvs.sourceforge.net/mod-fcgid/mod_fcgid/arch/unix/fcgid_proctbl_unix.c?r1=1.7&amp;r2=1.8 からパクる。</li>
<li>set_ignore_contenttype_config() がセグフォるので修正</li>
</ul>


<pre><code>=== mod_dosdetector.c
==================================================================
--- mod_dosdetector.c   (revision 804)
+++ mod_dosdetector.c   (local)
@@ -28,7 +28,6 @@
 #include <arpa/inet.h>
 //#include <netinet/in.h>
 #include <time.h>
-#include <regex.h>
 #include "httpd.h"
 #include "http_config.h"
 #include "http_request.h"
@@ -41,6 +40,7 @@
 #include "apr_strings.h"
 #include "apr_shm.h"
 #include "apr_thread_mutex.h"
+#include "apr_version.h"
 
 //#define _DEBUG
 
@@ -102,7 +102,90 @@
 static apr_global_mutex_t *lock = NULL;
 static apr_shm_t *shm = NULL;
 
+/* apr version 0.x not support apr_shm_remove, I have to copy it from apr version 1.x */
+#if (APR_MAJOR_VERSION < 1)
+#ifdef HAVE_SYS_MMAN_H
+#include <sys/mman.h>
+#endif
+#ifdef HAVE_SYS_IPC_H
+#include <sys/ipc.h>
+#endif
+#ifdef HAVE_SYS_MUTEX_H
+#include <sys/mutex.h>
+#endif
+#ifdef HAVE_SYS_SHM_H
+#include <sys/shm.h>
+#endif
+#if !defined(SHM_R)
+#define SHM_R 0400
+#endif
+#if !defined(SHM_W)
+#define SHM_W 0200
+#endif
+#ifdef HAVE_SYS_FILE_H
+#include <sys/file.h>
+#endif
 
+static apr_status_t apr_shm_remove(const char *filename, apr_pool_t * pool)
+{
+#if APR_USE_SHMEM_SHMGET
+   apr_status_t status;
+   apr_file_t *file;
+   key_t shmkey;
+   int shmid;
+#endif
+
+#if APR_USE_SHMEM_MMAP_TMP
+   return apr_file_remove(filename, pool);
+#endif
+#if APR_USE_SHMEM_MMAP_SHM
+   if (shm_unlink(filename) == -1) {
+       return errno;
+   }
+   return APR_SUCCESS;
+#endif
+#if APR_USE_SHMEM_SHMGET
+   /* Presume that the file already exists; just open for writing */
+   status = apr_file_open(&file, filename, APR_WRITE,
+                          APR_OS_DEFAULT, pool);
+   if (status) {
+       return status;
+   }
+
+   /* ftok() (on solaris at least) requires that the file actually
+    * exist before calling ftok(). */
+   shmkey = ftok(filename, 1);
+   if (shmkey == (key_t) - 1) {
+       goto shm_remove_failed;
+   }
+
+   apr_file_close(file);
+
+   if ((shmid = shmget(shmkey, 0, SHM_R | SHM_W)) < 0) {
+       goto shm_remove_failed;
+   }
+
+   /* Indicate that the segment is to be destroyed as soon
+    * as all processes have detached. This also disallows any
+    * new attachments to the segment. */
+   if (shmctl(shmid, IPC_RMID, NULL) == -1) {
+       goto shm_remove_failed;
+   }
+   return apr_file_remove(filename, pool);
+
+  shm_remove_failed:
+   status = errno;
+   /* ensure the file has been removed anyway. */
+   apr_file_remove(filename, pool);
+   return status;
+#endif
+
+   /* No support for anonymous shm */
+   return APR_ENOTIMPL;
+}
+#endif                         /* APR_MAJOR_VERSION<1 */
+
+
 static apr_status_t cleanup_shm(void *not_used)
 {
     ap_log_error(APLOG_MARK, APLOG_STARTUP, 0, NULL, "Notice: cleaning up shared memory");
@@ -261,8 +344,8 @@
 
    address = r->connection->remote_ip;
 
-    ap_regmatch_t regmatch[AP_MAX_REG_MATCH];
-    ap_regex_t **contenttype_regexp = (ap_regex_t **) cfg->contenttype_regexp->elts;
+    regmatch_t regmatch[AP_MAX_REG_MATCH];
+    regex_t **contenttype_regexp = (regex_t **) cfg->contenttype_regexp->elts;
    for (i = 0; i < cfg->contenttype_regexp->nelts; i++) {
        if(!ap_regexec(contenttype_regexp[i], content_type, AP_MAX_REG_MATCH, regmatch, 0)){
            //ap_log_error(APLOG_MARK, APLOG_NOTICE, 0, 0, "ignoring content-type: %s", content_type);
@@ -390,15 +473,13 @@
                     const char *arg)
 {
     dosdetector_dir_config *cfg = (dosdetector_dir_config *) mconfig;
-    char **ignore_contenttype = (char **) cfg->ignore_contenttype->elts;
+    regex_t *regexp;
+    char *type;
 
-    *(char **) apr_array_push(cfg->ignore_contenttype) = apr_pstrdup(parms->pool, arg);
-
-   int i;
-   regex_t *regexp;
-   for (i = 0; i < cfg->ignore_contenttype->nelts; i++) {
-        regexp = (regex_t *)ap_pregcomp(parms->pool, (char *)ignore_contenttype[i], REG_EXTENDED|REG_ICASE);
-       *(regex_t **)apr_array_push(cfg->contenttype_regexp) = regexp;
+    while (*arg) {
+      type = ap_getword_conf(parms->pool, &arg);
+      regexp = ap_pregcomp(parms->pool, type, REG_EXTENDED|REG_ICASE);
+      *(regex_t **)apr_array_push(cfg->contenttype_regexp) = regexp;
     }
 
     return NULL;
</code></pre>


<p>2.0 系でも 2.2 系でもどっちでも動くように修正した方がいいんだろうけど、それはまた今度。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/07/09/library-perl-trunk-Parse-Apache-ServerStatus-Extended-lib-Parse-Apache-ServerStatus-Extended.pm/">Library/Perl/Trunk/Parse Apache Server Status Extended/Lib/Parse/Apache/Server Status/Extended.Pm</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2007-07-09T21:03:59+09:00" pubdate>Jul 9<span>th</span>, 2007</time>
        
         | <a href="/blog/2007/07/09/library-perl-trunk-Parse-Apache-ServerStatus-Extended-lib-Parse-Apache-ServerStatus-Extended.pm/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>source:library/perl/trunk/Parse-Apache-ServerStatus-Extended/lib/Parse/Apache/ServerStatus/Extended.pm</p>

<h1>NAME</h1>

<p>Parse::Apache::ServerStatus::Extended - Simple module to parse apache&#8217;s extended server-status.</p>

<h1>SYNOPSIS</h1>

<pre><code>    use Parse::Apache::ServerStatus::Extended;

    my $parser = Parse::Apache::ServerStatus::Extended-&gt;new;

    $parser-&gt;request(
       url     =&gt; 'http://localhost/server-status',
       timeout =&gt; 30
    ) or die $parser-&gt;errstr;

    my $stat = $parser-&gt;parse or die $parser-&gt;errstr;

    # or both in one step

    my $stats = $parser-&gt;get(
       url     =&gt; 'http://localhost/server-status',
       timeout =&gt; 30
    ) or die $parser-&gt;errstr;
</code></pre>

<h1>DESCRIPTION</h1>

<p>This module parses the content of apache&#8217;s extended server-status.It works nicely with apache versions 1.3 and 2.x.</p>

<h1>METHODS</h1>

<h2>new()</h2>

<p>Call <code>new()</code> to create a new Parse::Apache::ServerStatus::Extended object.</p>

<h2>request()</h2>

<p>This method accepts one or two arguments: <code>url</code> and <code>timeout</code>. It requests the url and safes the content into the object. The option <code>timeout</code> is set to 180 seconds if it is not set.</p>

<h2>parse()</h2>

<p>Call <code>parse()</code> to parse the extended server status. This method returns an array reference with the parsed content.</p>

<p>It&#8217;s possible to call <code>parse()</code> with the content as an argument.</p>

<pre><code>    my $stat = $prs-&gt;parse($content);
</code></pre>

<p>If no argument is passed then <code>parse()</code> looks into the object for the content that is stored by <code>request()</code>.</p>

<h2>get()</h2>

<p>Call <code>get()</code> to <code>request()</code> and <code>parse()</code> in one step. It accepts the same options like <code>request()</code> and returns the array reference that is returned by <code>parse()</code>.</p>

<h1>SEE ALSO</h1>

<p>Parse::Apache::ServerStatus</p>

<h1>AUTHOR</h1>

<p>Gosuke Miyashita <code>&lt;gosukenator at gmail.com&gt;</code></p>

<h1>LICENCE AND COPYRIGHT</h1>

<p>This module is free software; you can redistribute it and/or modify it under the same terms as Perl itself. See perlartistic.</p>

<h1>DISCLAIMER OF WARRANTY</h1>

<p>BECAUSE THIS SOFTWARE IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY FOR THE SOFTWARE, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES PROVIDE THE SOFTWARE &#8220;AS IS&#8221; WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE SOFTWARE IS WITH YOU. SHOULD THE SOFTWARE PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR, OR CORRECTION.</p>

<p>IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR REDISTRIBUTE THE SOFTWARE AS PERMITTED BY THE ABOVE LICENCE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE SOFTWARE (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE SOFTWARE TO OPERATE WITH ANY OTHER SOFTWARE), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/06/30/518/">Puppet の連載はじめました</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2007-06-30T15:10:00+09:00" pubdate>Jun 30<span>th</span>, 2007</time>
        
         | <a href="/blog/2007/06/30/518/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://gihyo.jp/admin/serial/01/puppet">gihyo.jp で Puppet に関する連載をはじめました。</a></p>

<p>第1回目は、システム管理の自動化がなぜ必要なのか、ということと、Puppet がどういったツールなのか、その概要について書いています。</p>

<p>この連載を一通り読めば、Puppet をシステム管理の現場で実践するための十分な知識が得られる、といったものを目指しています。</p>

<p>分かりにくいなどご意見ございましたら、ぜひお知らせください。</p>

<p>3週間毎に更新予定です。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/06/14/517/">紫色の何かを口に押し付けている…</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2007-06-14T13:02:00+09:00" pubdate>Jun 14<span>th</span>, 2007</time>
        
         | <a href="/blog/2007/06/14/517/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>会社に紫色のブツがあったので。</p>

<p><img src="http://blog.mizzy.org/files/something_purple.jpg" title="紫" alt="紫" /></p>

<p>この写真は DPL(Dr.Pepper License) により保護されています。ドクターペッパー1本おごってくれれば、自由に使ってもらって構いません。（ライセンス発案者は <a href="http://d.hatena.ne.jp/tokuhirom/">id:tokuhirom</a> さんと <a href="http://d.hatena.ne.jp/hirose31/">id:hirose31</a>  さん）</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/06/14/516/">紫色の何かを口に押し付けている…</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2007-06-14T12:34:00+09:00" pubdate>Jun 14<span>th</span>, 2007</time>
        
         | <a href="/blog/2007/06/14/516/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>会社に紫色のブツがあったので…</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/14/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/12/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/03/07/image-with-exif-tag-plugin/">Image with EXIF tag plugin</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/03/07/exif-tag-plugin/">EXIF tag plugin</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/03/04/rakuten-tag-plugin/">Rakuten tag plugin for Jekyll</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/02/29/paperboys-engineer-evaluation-system/">Paperboy&#8217;s engineer evaluation system</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/01/17/paperboy-is-hiring/">paperboy is hiring</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Coderwall</h1>
  <p>
  <script type="text/javascript">
    function display_coderwall(args) {
        var badges = args["data"]["badges"];
        for ( var i = 0; i < badges.length; i++ ) {
            document.write('<img src="'+ badges[i]["badge"] + '" width="48" height="48" />');
        }
    }
  </script>
  <script src="http://coderwall.com/mizzy.json?callback=display_coderwall"></script>
  </p>
  <p style="text-align: right;"><a href="http://coderwall.com/mizzy">Powered by coderwall.com</a></p>
</section>


<section>
  <h1>Github Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/mizzy">@mizzy</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'mizzy',
            count: 30,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>




  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Gosuke Miyashita -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'mizzyorg';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
